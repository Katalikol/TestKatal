from flask import Flask, redirect
import sqlite3

app = Flask(__name__)

# Функция для получения всех пользователей из базы данных
def get_users():
    conn = sqlite3.connect('users.db')
    cursor = conn.cursor()
    cursor.execute('SELECT user_id, username, name FROM users')
    users = cursor.fetchall()  # Получаем все данные о пользователях
    conn.close()
    return users

@app.route('/')
def index():
    users = get_users()

    # Создаем строку с данными пользователей для вставки в HTML
    user_data = ""
    for user in users:
        user_data += f"<tr><td>{user[0]}</td><td>@{user[1]}</td><td>{user[2]}</td></tr>"

    # HTML-шаблон, который будет содержать данные пользователей
    html_content = f"""
    <!doctype html>
    <html lang="ru">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Список пользователей</title>
        <style>
            table {{
                width: 100%;
                border-collapse: collapse;
            }}

            table, th, td {{
                border: 1px solid black;
            }}

            th, td {{
                padding: 10px;
                text-align: left;
            }}
        </style>
    </head>
    <body>
        <h1>Список пользователей</h1>
        <table>
            <thead>
                <tr>
                    <th>User ID</th>
                    <th>Username</th>
                    <th>Имя</th>
                </tr>
            </thead>
            <tbody>
                {user_data}
            </tbody>
        </table>
    </body>
    </html>
    """

    return html_content  # Возвращаем HTML-контент с данными

if __name__ == '__main__':
    app.run(debug=True)
